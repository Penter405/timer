<!doctype html>
<html lang="zh-Hant">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>魔方計時器</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="wrap">
        <header>
            <div class="header-left">
                <h1 id="navTitle" style="cursor:pointer;">Timer</h1>
                <nav class="navbar">
                    <div id="g_id_onload"
                        data-client_id="989488402816-0cvnhchjvak4f16vf1d54pnbhm0dvh3k.apps.googleusercontent.com"
                        data-callback="handleCredentialResponse" data-auto_select="true" data-itp_support="true">
                    </div>
                    <div class="g_id_signin" data-type="icon" data-shape="circle" data-theme="outline"
                        data-text="signin_with" data-size="large" data-logo_alignment="left"></div>
                    <button id="navLogout" class="nav-btn hidden">登出</button>
                    <div style="width: 10px;" class="spacer"></div>
                    <button id="navMore" class="nav-btn">更多</button>
                </nav>
            </div>
        </header>

        <!-- Multi-Page Container -->
        <div id="homePage" class="page active">
            <div class="grid">
                <div class="card">
                    <div class="timer">
                        <div id="inspection" style="color:var(--muted);font-size:14px">檢查：<span id="inspSec">-</span>
                        </div>
                        <div style="height:8px"></div>
                        <div class="time" id="display">00:00.00<span class="ms" id="ms"></span></div>
                        <div class="controls">
                            <button id="toggleInspection" class="small">開始檢查 (I)</button>
                            <button id="newScramble" class="small">新亂序 (S)</button>
                            <button id="startBtn" class="primary small">開始/停止 (Space)</button>
                        </div>
                        <div class="scramble" id="scramble">...</div>
                        <div style="margin-top:10px;font-size:13px;color:var(--muted)">
                            按下空白鍵或點擊 <strong>開始/停止</strong> 來計時。檢查時間 15 秒（可關閉）。
                        </div>
                    </div>
                </div>
                <div class="card stats">
                    <div class="stat-row">
                        <div>最近時間</div>
                        <div id="last">-</div>
                    </div>
                    <div class="stat-row">
                        <div>平均 (Ao5)</div>
                        <div id="ao5">-</div>
                    </div>
                    <div class="stat-row">
                        <div>平均 (Ao12)</div>
                        <div id="ao12">-</div>
                    </div>
                    <div class="stat-row">
                        <div>最佳</div>
                        <div id="best">-</div>
                    </div>
                    <div class="stat-row">
                        <div>最差</div>
                        <div id="worst">-</div>
                    </div>
                    <div style="display:flex;gap:8px;margin-top:8px">
                        <button id="exportCsv" class="small">匯出 CSV</button>
                        <button id="clear" class="small">清除紀錄</button>
                    </div>
                    <div class="history" id="history"></div>
                </div>
            </div>
        </div>

        <!-- Scoreboard Page -->
        <div id="scoreboardPage" class="page">
            <div class="page-content">
                <h2>🏆 記分板</h2>

                <!-- Filter Controls -->
                <div class="scoreboard-filters">
                    <!-- Row 1: Timezone and Time Period -->
                    <div class="filter-row">
                        <div class="filter-group">
                            <label for="timezoneSelect">時區</label>
                            <select id="timezoneSelect">
                                <option value="Europe/London">🇬🇧 英國 (GMT/BST)</option>
                                <option value="Asia/Taipei">🇹🇼 台灣 (UTC+8)</option>
                                <option value="Asia/Tokyo">🇯🇵 日本 (UTC+9)</option>
                                <option value="Asia/Shanghai">🇨🇳 中國 (UTC+8)</option>
                                <option value="America/New_York">🇺🇸 美東 (EST/EDT)</option>
                                <option value="America/Los_Angeles">🇺🇸 美西 (PST/PDT)</option>
                                <option value="UTC">🌍 UTC</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="periodSelect">統計時間</label>
                            <select id="periodSelect">
                                <option value="all">📊 歷史</option>
                                <option value="year">📅 本年</option>
                                <option value="month">🗓️ 本月</option>
                                <option value="week">📆 本周</option>
                                <option value="today">🌅 本日</option>
                            </select>
                        </div>
                    </div>

                    <!-- Row 2: Toggle Switch and Submit -->
                    <div class="filter-row">
                        <div class="filter-group toggle-group">
                            <label>單一玩家最多一筆</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="uniqueToggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <button id="scoreboardSubmit" class="submit-btn">查詢</button>
                    </div>
                </div>

                <div id="leaderboard" class="card">
                    <p>點擊「查詢」以載入排行榜</p>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settingsPage" class="page">
            <div class="page-content">
                <h2>⚙️ 用戶設定</h2>
                <div class="card">
                    <div class="settings-item">
                        <label>暱稱</label>
                        <div class="input-row" style="display:flex; gap:8px;">
                            <input type="text" id="settingsNickname" placeholder="輸入暱稱" style="flex:1; min-width:0;">
                            <button id="updateNicknameBtn" class="btn-primary"
                                style="padding:6px 12px; white-space:nowrap;">上傳</button>
                            <span id="nicknameGreeting"
                                style="margin-left:8px; color:var(--accent); white-space:nowrap; align-self:center; font-size: 0.9em;"></span>
                        </div>
                    </div>
                    <div class="settings-group">
                        <label>檢查時間 (秒)</label>
                        <input type="number" id="settingsInspectionTime" value="15" min="0" max="30">
                    </div>
                    <div class="settings-group">
                        <label>主題</label>
                        <select id="settingsTheme">
                            <option value="dark">深色</option>
                            <option value="light">淺色 (開發中)</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- More Menu Page -->
        <div id="morePage" class="page">
            <div class="page-content">
                <h2>更多選項</h2>
                <div class="more-menu">
                    <button id="moreSettings" class="more-item">
                        <span class="icon">⚙️</span>
                        <span>用戶設定</span>
                    </button>
                    <button id="moreScoreboard" class="more-item">
                        <span class="icon">🏆</span>
                        <span>記分板</span>
                    </button>
                </div>
            </div>
        </div>

        <footer>儲存：使用 localStorage（僅本機）。亂序產生器為 3x3 常用步驟。歡迎回報想要的功能。</footer>
    </div>
    <script src="js/scoreboard.js?v=nocache"></script>
    <script src="js/router.js?v=nocache"></script>
    <script src="js/connect.js?v=nocache"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="script.js?v=nocache"></script>
</body>

</html>